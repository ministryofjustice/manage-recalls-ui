{% extends "../partials/layout.njk" %}
{% from "govuk/components/table/macro.njk" import govukTable %}
{%- from "moj/components/search/macro.njk" import mojSearch -%}
{% from "govuk/components/button/macro.njk" import govukButton %}

{% set pageTitle = applicationName + " - Assess a recall" %}

{% block content %}

    <div class="govuk-grid-row">
        <div class="govuk-grid-column-full">
            <h1 class="govuk-heading-l" data-qa='personName'>
                {{ person.firstName }} {{ person.lastName }}
            </h1>
            <h2 class='govuk-heading-m'>About the person</h2>
            <dl class="govuk-summary-list">
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">
                        First name
                    </dt>
                    <dd class="govuk-summary-list__value">
                        {{ person.firstName }}
                    </dd>
                </div>
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">
                        Middle names
                    </dt>
                    <dd class="govuk-summary-list__value">
                        {{ person.middleNames }}
                    </dd>
                </div>
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">
                        Last name
                    </dt>
                    <dd class="govuk-summary-list__value">
                        {{ person.lastName }}
                    </dd>
                </div>
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">
                        Date of birth
                    </dt>
                    <dd class="govuk-summary-list__value">
                        {{ person.dateOfBirth | dateGov }}
                    </dd>
                </div>
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">
                        Gender
                    </dt>
                    <dd class="govuk-summary-list__value">
                        {{ person.gender }}
                    </dd>
                </div>
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">
                        CRO
                    </dt>
                    <dd class="govuk-summary-list__value">
                        {{ person.croNumber }}
                    </dd>
                </div>
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">
                        PNC
                    </dt>
                    <dd class="govuk-summary-list__value">
                        {{ person.pncNumber }}
                    </dd>
                </div>
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">
                        NOMIS
                    </dt>
                    <dd class="govuk-summary-list__value">
                        {{ person.nomsNumber }}
                    </dd>
                </div>
            </dl>
            {% if recall %}
            <h2 class='govuk-heading-m'>Recall</h2>
            <dl class="govuk-summary-list">
                <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                    Length of fixed recall
                </dt>
                <dd class="govuk-summary-list__value" data-qa='recallLength'>
                   {{ recall.recallLengthFormatted }}
                </dd>
                </div>
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">
                        Date recall email was received
                    </dt>
                    <dd class="govuk-summary-list__value" data-qa='recallEmailReceivedDateTime'>
                        {{ recall.recallEmailReceivedDateTime | dateTime}}
                    </dd>
                </div>
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">
                        Releasing prison
                    </dt>
                    <dd class="govuk-summary-list__value" data-qa='lastReleasePrison'>
                        {{ recall.lastReleasePrison }}
                    </dd>
                </div>
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">
                        Last release date
                    </dt>
                    <dd class="govuk-summary-list__value" data-qa='lastReleaseDateTime'>
                        {{ recall.lastReleaseDateTime | dateGov }}
                    </dd>
                </div>
                <div class="govuk-summary-list__row">
                    <dt class="govuk-summary-list__key">
                        Local police station
                    </dt>
                    <dd class="govuk-summary-list__value" data-qa='localPoliceService'>
                        {{ recall.localPoliceService }}
                    </dd>
                </div>
            </dl>

            {% endif %}
            {% if recall.documents.length %}
            <h2 class='govuk-heading-m'>Uploaded documents</h2>
            <dl class="govuk-summary-list">
            {% for document in recall.documents %}
                    <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                    {{ document.label }}
                </dt>
                <dd class="govuk-summary-list__value">
                    <a href='/persons/{{ person.nomsNumber }}/recalls/{{ recall.recallId }}/documents/{{ document.documentId }}' data-qa='uploadedDocument-{{ document.category }}'>Download PDF</a>
                </dd>
                    </div>
            {% endfor %}
            </dl>
            {% endif %}

            <p class='govuk-body'>
                <a href="/persons/{{ person.nomsNumber }}/recalls/{{ recall.recallId }}/assess-decision" role='button' class="govuk-button" data-module="govuk-button"
                   data-qa="continueButton">
                    Assess this recall
                </a>
            </p>
        </div>
    </div>

{% endblock %}
